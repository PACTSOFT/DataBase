USE PACT2C222
GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[spCRM_GetCampaignDetails]
	@CampaignID [bigint] = 0,
	@ProductId [bigint] = 0,
	@UserId [int] = 0,
	@LangId [int] = 1
WITH ENCRYPTION, EXECUTE AS CALLER
AS
BEGIN TRY	
SET NOCOUNT ON

--if(@ProductId=0)
--BEGIN
--	SELECT * FROM INV_PRODUCT with(nolock)
--END

--ELSE
BEGIN
	select P.ProductCode,P.ProductName,U.BaseId,U.BaseName,U.UOMID,U.UnitName from
	Inv_Product  P WITH(NOLOCK) 	
	Left Join COM_UOM U WITH(NOLOCK)  on U.UomId =P.UomID
	Where P.ProductId=@ProductId

END
---PARAMERETS CHECK
 
		create table #tblUsers(username nvarchar(100))
		insert into #tblUsers
		exec [spADM_GetUserNamebyOwner] @UserID 
	if(@CampaignID>0)
	BEGIN
			SELECT Code,Name,StatusID,CampaignTypeLookupID,ExpectedResponse,Offer,convert(datetime,ProposedStartDate) as ProposedStartDate, convert(datetime,ProposedEndDate) as ProposedEndDate,convert(datetime,ActualStartDate) as ActualStartDate,
			convert(datetime,ActualEndDate) as ActualEndDate,BudgetAllocated,EstimatedRevenue,VendorLookupID,ParentID,
				Venue, CodePrefix, CodeNumber, IsApproved,ApprovedBy,Convert(datetime,ApprovedDate) ApprovedDate
			 FROM CRM_CAMPAIGNS  WITH(NOLOCK) 	
			 WHERE CAMPAIGNID= @CampaignID 
			 SELECT CP.ProductID,P.ProductName,CP.UomID,U.UnitName,CP.UnitPrice FROM CRM_CampaignProducts as CP
			 Left Join COM_UOM  U WITH(NOLOCK) 	on U.UomId =CP.UomID
			 Left Join Inv_Product  P  WITH(NOLOCK) 	on P.ProductId=CP.ProductId
			 WHERE CAMPAIGNID= @CampaignID

			 		--Getting CostCenterMap
		SELECT * FROM  COM_CCCCData WITH(NOLOCK) 
		WHERE NodeID=@CampaignID and CostCenterID=88
    END
	else
		select 1

		SELECT R.CampaignResponseID, C.Name as Campaign,R.CampaignID, L.Name as [Type],R.CampgnRespLookupID as TypeID,Convert(datetime,ReceivedDate) as [Date],CompanyName,
		Cus.CustomerName as Customer,R.CustomerID,R.Description,ContactName,Phone,Email,Fax,
		LL.Name as Channel,R.ChannelLookupID as ChannelID,A.CustomerName as Vendor,R.VendorLookupID as VendorID,
		[FirstName],[MiddleName],[LastName],[JobTitle],[Department],[Address1],[Address2],[Address3],[City],[State]
	   ,[Zip],[Country],[Phone2],[Email2],[URL],[Alpha1],[Alpha2],[Alpha3],[Alpha4],[Alpha5],[Alpha6],[Alpha7]
	   ,[Alpha8],[Alpha9],[Alpha10],[Alpha11],[Alpha12],[Alpha13],[Alpha14],[Alpha15],[Alpha16],[Alpha17],[Alpha18]
	   ,[Alpha19],[Alpha20],[Alpha21],[Alpha22],[Alpha23],[Alpha24],[Alpha25],[Alpha26],[Alpha27],[Alpha28],[Alpha29]
	   ,[Alpha30],[Alpha31],[Alpha32],[Alpha33],[Alpha34],[Alpha35],[Alpha36],[Alpha37],[Alpha38],[Alpha39],[Alpha40]
	   ,[Alpha41],[Alpha42],[Alpha43],[Alpha44],[Alpha45],[Alpha46],[Alpha47],[Alpha48],[Alpha49],[Alpha50]
	   ,[CCNID1],[CCNID2],[CCNID3],[CCNID4],[CCNID5],[CCNID6],[CCNID7],[CCNID8],[CCNID9],[CCNID10],[CCNID11]
	   ,[CCNID12],[CCNID13],[CCNID14],[CCNID15],[CCNID16],[CCNID17],[CCNID18],[CCNID19],[CCNID20]
	   ,[CCNID21],[CCNID22],[CCNID23],[CCNID24],[CCNID25],[CCNID26],[CCNID27],[CCNID28],[CCNID29],[CCNID30]
	   ,[CCNID31],[CCNID32],[CCNID33],[CCNID34],[CCNID35],[CCNID36],[CCNID37],[CCNID38],[CCNID39],[CCNID40]
	   ,[CCNID41],[CCNID42],[CCNID43],[CCNID44],[CCNID45],[CCNID46],[CCNID47],[CCNID48],[CCNID49],[CCNID50], r.ConvertedLeadID,
	   NID1.NAME as NAME1,NID2.NAME as NAME2,NID3.NAME as NAME3,NID4.NAME as NAME4,NID5.NAME as NAME5,NID6.NAME as NAME6,NID7.NAME as NAME7,NID8.NAME as NAME8,NID9.NAME as NAME9,NID10.NAME  AS NAME10,
    	NID11.NAME  AS NAME11,NID12.NAME  AS NAME12,NID13.NAME  AS NAME13,NID14.NAME  AS NAME14,NID15.NAME  AS NAME15,NID16.NAME  AS NAME16,NID17.NAME  AS NAME17,NID18.NAME  AS NAME18,NID19.NAME  AS NAME19,NID20.NAME  AS NAME20,
		NID21.NAME  AS NAME21,NID22.NAME  AS NAME22,NID23.NAME  AS NAME23,NID24.NAME  AS NAME24,NID25.NAME  AS NAME25,NID26.NAME  AS NAME26,NID27.NAME  AS NAME27,NID28.NAME  AS NAME28,NID29.NAME  AS NAME29,NID30.NAME  AS NAME30,
		NID31.NAME  AS NAME31,NID32.NAME  AS NAME32,NID33.NAME  AS NAME33,NID34.NAME  AS NAME34,NID35.NAME  AS NAME35,NID36.NAME  AS NAME36,NID37.NAME  AS NAME37,NID38.NAME  AS NAME38,NID39.NAME  AS NAME39,NID40.NAME  AS NAME40,
		NID41.NAME  AS NAME41,NID42.NAME  AS NAME42,NID43.NAME  AS NAME43,NID44.NAME  AS NAME44,NID45.NAME  AS NAME45,NID46.NAME  AS NAME46,NID47.NAME  AS NAME47,NID48.NAME  AS NAME48,NID49.NAME  AS NAME49,NID50.NAME  AS NAME50 
		 FROM  CRM_CAMPAIGNRESPONSE as R WITH(NOLOCK) 	
		left join CRM_Campaigns as C WITH(NOLOCK) 	on C.CampaignID =R.CampaignID
		left join com_lookup as L WITH(NOLOCK) 	on L.NodeID = R.CampgnRespLookupID
		left join crm_customer as Cus WITH(NOLOCK) 	on Cus.CustomerID = R.CustomerID
		left join com_lookup as LL WITH(NOLOCK) 	on LL.NodeID = R.ChannelLookupID
		left join CRM_Customer as A WITH(NOLOCK) 	on A.CustomerID = R.VendorLookupID
		LEFT JOIN COM_DIVISION NID1 WITH(NOLOCK) 	on R.CCNID1=NID1.NODEID
			LEFT JOIN COM_Location NID2 WITH(NOLOCK) 	on R.CCNID2=NID2.NODEID
			LEFT JOIN COM_Branch NID3 WITH(NOLOCK) 	on R.CCNID3=NID3.NODEID
			LEFT JOIN COM_Department NID4 WITH(NOLOCK) 	on R.CCNID4=NID4.NODEID
			LEFT JOIN COM_Salesman NID5 WITH(NOLOCK) 	on R.CCNID5=NID5.NODEID
			LEFT JOIN COM_Category NID6 WITH(NOLOCK) 	on R.CCNID6=NID6.NODEID
			LEFT JOIN COM_Area NID7 WITH(NOLOCK) 	on R.CCNID7=NID7.NODEID
			LEFT JOIN COM_Teritory NID8 WITH(NOLOCK) 	on R.CCNID8=NID8.NODEID
			LEFT JOIN COM_CC50009 NID9 WITH(NOLOCK) 	on R.CCNID9=NID9.NODEID
			LEFT JOIN COM_CC50010 NID10 WITH(NOLOCK) 	on R.CCNID10=NID10.NODEID
			LEFT JOIN COM_CC50011 NID11 WITH(NOLOCK) 	on R.CCNID11=NID11.NODEID
			LEFT JOIN COM_CC50012 NID12 WITH(NOLOCK) 	on R.CCNID12=NID12.NODEID
			LEFT JOIN COM_CC50013 NID13 WITH(NOLOCK) 	on R.CCNID13=NID13.NODEID
			LEFT JOIN COM_CC50014 NID14 WITH(NOLOCK) 	on R.CCNID14=NID14.NODEID
			LEFT JOIN COM_CC50015 NID15 WITH(NOLOCK) 	 on R.CCNID15=NID15.NODEID
			LEFT JOIN COM_CC50016 NID16 WITH(NOLOCK) 	on R.CCNID16=NID16.NODEID
			LEFT JOIN COM_CC50017 NID17 WITH(NOLOCK) 	on R.CCNID17=NID17.NODEID
			LEFT JOIN COM_CC50018 NID18 WITH(NOLOCK) 	on R.CCNID18=NID18.NODEID
			LEFT JOIN COM_CC50019 NID19 WITH(NOLOCK) 	on R.CCNID19=NID19.NODEID 
			LEFT JOIN COM_CC50020 NID20 WITH(NOLOCK) 	ON R.CCNID20=NID20.NODEID
			LEFT JOIN COM_CC50021 NID21 WITH(NOLOCK) 	ON R.CCNID21=NID21.NODEID
			LEFT JOIN COM_CC50022 NID22 WITH(NOLOCK) 	ON R.CCNID22=NID22.NODEID
			LEFT JOIN COM_CC50023 NID23 WITH(NOLOCK) 	ON R.CCNID23=NID23.NODEID
			LEFT JOIN COM_CC50024 NID24 WITH(NOLOCK) 	ON R.CCNID24=NID24.NODEID
			LEFT JOIN COM_CC50025 NID25 WITH(NOLOCK) 	ON R.CCNID25=NID25.NODEID
			LEFT JOIN COM_CC50026 NID26 WITH(NOLOCK) 	ON R.CCNID26=NID26.NODEID
			LEFT JOIN COM_CC50027 NID27 WITH(NOLOCK) 	ON R.CCNID27=NID27.NODEID
			LEFT JOIN COM_CC50028 NID28 WITH(NOLOCK) 	ON R.CCNID28=NID28.NODEID
			LEFT JOIN COM_CC50029 NID29 WITH(NOLOCK) 	ON R.CCNID29=NID29.NODEID 
			LEFT JOIN COM_CC50030 NID30 WITH(NOLOCK) 	ON R.CCNID30=NID30.NODEID
			LEFT JOIN COM_CC50031 NID31 WITH(NOLOCK) 	ON R.CCNID31=NID31.NODEID
			LEFT JOIN COM_CC50032 NID32 WITH(NOLOCK) 	ON R.CCNID32=NID32.NODEID
			LEFT JOIN COM_CC50033 NID33 WITH(NOLOCK) 	ON R.CCNID33=NID33.NODEID
			LEFT JOIN COM_CC50034 NID34 WITH(NOLOCK) 	ON R.CCNID34=NID34.NODEID
			LEFT JOIN COM_CC50035 NID35 WITH(NOLOCK) 	ON R.CCNID35=NID35.NODEID
			LEFT JOIN COM_CC50036 NID36 WITH(NOLOCK) 	ON R.CCNID36=NID36.NODEID
			LEFT JOIN COM_CC50037 NID37 WITH(NOLOCK) 	ON R.CCNID37=NID37.NODEID
			LEFT JOIN COM_CC50038 NID38 WITH(NOLOCK) 	ON R.CCNID38=NID38.NODEID
			LEFT JOIN COM_CC50039 NID39 WITH(NOLOCK) 	ON R.CCNID39=NID39.NODEID 
			LEFT JOIN COM_CC50040 NID40 WITH(NOLOCK) 	ON R.CCNID40=NID40.NODEID
			LEFT JOIN COM_CC50041 NID41 WITH(NOLOCK) 	ON R.CCNID41=NID41.NODEID
			LEFT JOIN COM_CC50042 NID42 WITH(NOLOCK) 	ON R.CCNID42=NID42.NODEID
			LEFT JOIN COM_CC50043 NID43 WITH(NOLOCK) 	ON R.CCNID43=NID43.NODEID
			LEFT JOIN COM_CC50044 NID44 WITH(NOLOCK) 	ON R.CCNID44=NID44.NODEID
			LEFT JOIN COM_CC50045 NID45 WITH(NOLOCK) 	ON R.CCNID45=NID45.NODEID
			LEFT JOIN COM_CC50046 NID46 WITH(NOLOCK) 	ON R.CCNID46=NID46.NODEID
			LEFT JOIN COM_CC50047 NID47 WITH(NOLOCK) 	ON R.CCNID47=NID47.NODEID
			LEFT JOIN COM_CC50048 NID48 WITH(NOLOCK) 	ON R.CCNID48=NID48.NODEID
			LEFT JOIN COM_CC50049 NID49 WITH(NOLOCK) 	ON R.CCNID49=NID49.NODEID 
			LEFT JOIN COM_CC50050 NID50 WITH(NOLOCK) 	ON R.CCNID50=NID50.NODEID
		 WHERE R.CAMPAIGNID=@CampaignID
		 
		 
		SELECT C.Name as Campaign,A.CampaignID,A.Name,S.Status as [Status],A.StatusID,L.Name as Channel,A.ChannelLookupID,
		L2.CustomerName as Vendor, A.VendorLookupID,L3.Name as Type,A.TypeLookupID,L4.Name as Priority,A.PriorityTypeLookupID,
		A.Description,Convert(datetime,A.StartDate) as StartDate,Convert(datetime,A.EndDate)as EndDate,A.BudgetedAmount,ActualCost,
		CC.Name as Currency,A.CurrencyID
		, A.CompletionRate, A.WorkingHrs, A.CheckList,A.CloseStatus,Convert(datetime,A.CloseDate) as  CloseDate 
		,A.ClosedRemarks
		FROM CRM_CampaignActivities as A WITH(NOLOCK) 	
		left join CRM_Campaigns as C WITH(NOLOCK) 	on C.CampaignID =A.CampaignID
		left join COM_Status as S WITH(NOLOCK) 	on S.StatusID=A.StatusID
		left join com_lookup as L WITH(NOLOCK) 	on L.NodeID = A.ChannelLookupID
		LEFT JOIN CRM_Customer AS L2 WITH(NOLOCK) ON L2.CustomerID=A.VendorLookupID		
		left join com_lookup as L3 WITH(NOLOCK) 	on L3.NodeID = A.TypeLookupID
		left join com_lookup as L4 WITH(NOLOCK) 	on L4.NodeID = A.PriorityTypeLookupID
		left join com_currency as CC WITH(NOLOCK) 	on CC.CurrencyID = A.CurrencyID
		WHERE A.CampaignID=@CampaignID
		select * from com_lookup WITH(NOLOCK) 	where lookuptype=25
		select * from com_lookup WITH(NOLOCK) 	where lookuptype=27
		select * from com_lookup WITH(NOLOCK) 	where lookuptype=28
		select * from com_lookup WITH(NOLOCK) 	where lookuptype=29
		select * from com_lookup WITH(NOLOCK) 	where lookuptype=30

Select D.*,convert(datetime,D.date) d ,
NID1.NAME as NAME1,
NID2.NAME as NAME2,
NID3.NAME as NAME3,
NID4.NAME as NAME4,
NID5.NAME as NAME5,
NID6.NAME as NAME6,
NID7.NAME as NAME7,
NID8.NAME as NAME8,
NID9.NAME as NAME9,
NID10.NAME  AS NAME10,
NID11.NAME  AS NAME11,
NID12.NAME  AS NAME12,
NID13.NAME  AS NAME13,
NID14.NAME  AS NAME14,
NID15.NAME  AS NAME15,
NID16.NAME  AS NAME16,
NID17.NAME  AS NAME17,
NID18.NAME  AS NAME18,
NID19.NAME  AS NAME19,
NID20.NAME  AS NAME20,
NID21.NAME  AS NAME21,
NID22.NAME  AS NAME22,
NID23.NAME  AS NAME23,
NID24.NAME  AS NAME24,
NID25.NAME  AS NAME25,
NID26.NAME  AS NAME26,
NID27.NAME  AS NAME27,
NID28.NAME  AS NAME28,
NID29.NAME  AS NAME29,
NID30.NAME  AS NAME30,
NID31.NAME  AS NAME31,
NID32.NAME  AS NAME32,
NID33.NAME  AS NAME33,
NID34.NAME  AS NAME34,
NID35.NAME  AS NAME35,
NID36.NAME  AS NAME36,
NID37.NAME  AS NAME37,
NID38.NAME  AS NAME38,
NID39.NAME  AS NAME39,
NID40.NAME  AS NAME40,
NID41.NAME  AS NAME41,
NID42.NAME  AS NAME42,
NID43.NAME  AS NAME43,
NID44.NAME  AS NAME44,
NID45.NAME  AS NAME45,
NID46.NAME  AS NAME46,
NID47.NAME  AS NAME47,
NID48.NAME  AS NAME48,
NID49.NAME  AS NAME49,
NID50.NAME  AS NAME50,Product.ProductName,Product.ProductID, isnull(D.Quantity,0) Quantity, 
isnull(D.UnitPrice,0) UnitPrice,isnull(D.Value,0) Value
from CRM_CampaignDemoKit D WITH(NOLOCK) 	
LEFT JOIN COM_DIVISION NID1 WITH(NOLOCK) 	on D.CCNID1=NID1.NODEID
LEFT JOIN COM_Location NID2 WITH(NOLOCK) 	on D.CCNID2=NID2.NODEID
LEFT JOIN COM_Branch NID3 WITH(NOLOCK) 	on D.CCNID3=NID3.NODEID
LEFT JOIN COM_Department NID4 WITH(NOLOCK) 	on D.CCNID4=NID4.NODEID
LEFT JOIN COM_Salesman NID5 WITH(NOLOCK) 	on D.CCNID5=NID5.NODEID
LEFT JOIN COM_Category NID6 WITH(NOLOCK) 	on D.CCNID6=NID6.NODEID
LEFT JOIN COM_Area NID7 WITH(NOLOCK) 	on D.CCNID7=NID7.NODEID
LEFT JOIN COM_Teritory NID8 WITH(NOLOCK) 	on D.CCNID8=NID8.NODEID
LEFT JOIN INV_PRODUCT Product WITH(NOLOCK) 	on D.ProductID=Product.ProductID
LEFT JOIN COM_CC50009 NID9 WITH(NOLOCK) 	on D.CCNID9=NID9.NODEID
LEFT JOIN COM_CC50010 NID10 WITH(NOLOCK) 	on D.CCNID10=NID10.NODEID
LEFT JOIN COM_CC50011 NID11 WITH(NOLOCK) 	on D.CCNID11=NID11.NODEID
LEFT JOIN COM_CC50012 NID12 WITH(NOLOCK) 	on D.CCNID12=NID12.NODEID
LEFT JOIN COM_CC50013 NID13 WITH(NOLOCK) 	on D.CCNID13=NID13.NODEID
LEFT JOIN COM_CC50014 NID14 WITH(NOLOCK) 	on D.CCNID14=NID14.NODEID
LEFT JOIN COM_CC50015 NID15 WITH(NOLOCK) 	on D.CCNID15=NID15.NODEID
LEFT JOIN COM_CC50016 NID16 WITH(NOLOCK) 	on D.CCNID16=NID16.NODEID
LEFT JOIN COM_CC50017 NID17 WITH(NOLOCK) 	on D.CCNID17=NID17.NODEID
LEFT JOIN COM_CC50018 NID18 WITH(NOLOCK) 	on D.CCNID18=NID18.NODEID
LEFT JOIN COM_CC50019 NID19 WITH(NOLOCK) 	on D.CCNID19=NID19.NODEID 
LEFT JOIN COM_CC50020 NID20 WITH(NOLOCK) 	ON D.CCNID20=NID20.NODEID
LEFT JOIN COM_CC50021 NID21 WITH(NOLOCK) 	ON D.CCNID21=NID21.NODEID
LEFT JOIN COM_CC50022 NID22 WITH(NOLOCK) 	ON D.CCNID22=NID22.NODEID
LEFT JOIN COM_CC50023 NID23 WITH(NOLOCK) 	ON D.CCNID23=NID23.NODEID
LEFT JOIN COM_CC50024 NID24 WITH(NOLOCK) 	ON D.CCNID24=NID24.NODEID
LEFT JOIN COM_CC50025 NID25 WITH(NOLOCK) 	ON D.CCNID25=NID25.NODEID
LEFT JOIN COM_CC50026 NID26 WITH(NOLOCK) 	ON D.CCNID26=NID26.NODEID
LEFT JOIN COM_CC50027 NID27 WITH(NOLOCK) 	ON D.CCNID27=NID27.NODEID
LEFT JOIN COM_CC50028 NID28 WITH(NOLOCK) 	ON D.CCNID28=NID28.NODEID
LEFT JOIN COM_CC50029 NID29 WITH(NOLOCK) 	ON D.CCNID29=NID29.NODEID 
LEFT JOIN COM_CC50030 NID30 WITH(NOLOCK) 	ON D.CCNID30=NID30.NODEID
LEFT JOIN COM_CC50031 NID31 WITH(NOLOCK) 	ON D.CCNID31=NID31.NODEID
LEFT JOIN COM_CC50032 NID32 WITH(NOLOCK) 	ON D.CCNID32=NID32.NODEID
LEFT JOIN COM_CC50033 NID33 WITH(NOLOCK) 	ON D.CCNID33=NID33.NODEID
LEFT JOIN COM_CC50034 NID34 WITH(NOLOCK) 	ON D.CCNID34=NID34.NODEID
LEFT JOIN COM_CC50035 NID35 WITH(NOLOCK) 	ON D.CCNID35=NID35.NODEID
LEFT JOIN COM_CC50036 NID36 WITH(NOLOCK) 	ON D.CCNID36=NID36.NODEID
LEFT JOIN COM_CC50037 NID37 WITH(NOLOCK) 	ON D.CCNID37=NID37.NODEID
LEFT JOIN COM_CC50038 NID38 WITH(NOLOCK) 	ON D.CCNID38=NID38.NODEID
LEFT JOIN COM_CC50039 NID39 WITH(NOLOCK) 	ON D.CCNID39=NID39.NODEID 
LEFT JOIN COM_CC50040 NID40 WITH(NOLOCK) 	ON D.CCNID40=NID40.NODEID
LEFT JOIN COM_CC50041 NID41 WITH(NOLOCK) 	ON D.CCNID41=NID41.NODEID
LEFT JOIN COM_CC50042 NID42 WITH(NOLOCK) 	ON D.CCNID42=NID42.NODEID
LEFT JOIN COM_CC50043 NID43 WITH(NOLOCK) 	ON D.CCNID43=NID43.NODEID
LEFT JOIN COM_CC50044 NID44 WITH(NOLOCK) 	ON D.CCNID44=NID44.NODEID
LEFT JOIN COM_CC50045 NID45 WITH(NOLOCK) 	ON D.CCNID45=NID45.NODEID
LEFT JOIN COM_CC50046 NID46 WITH(NOLOCK) 	ON D.CCNID46=NID46.NODEID
LEFT JOIN COM_CC50047 NID47 WITH(NOLOCK) 	ON D.CCNID47=NID47.NODEID
LEFT JOIN COM_CC50048 NID48 WITH(NOLOCK) 	ON D.CCNID48=NID48.NODEID
LEFT JOIN COM_CC50049 NID49 WITH(NOLOCK) 	ON D.CCNID49=NID49.NODEID 
LEFT JOIN COM_CC50050 NID50 WITH(NOLOCK) 	ON D.CCNID50=NID50.NODEID
where campaignNodeID=@CampaignID
 
Select P.ProductName as ProductName,P.ProductCode, U.UnitName as UOM,U.UnitName,L.CostCenterID,L.Description,L.CRMProduct,L.ProductMapID,L.CCNodeID,L.ProductID,L.UOMID,L.CurrencyID,CUR.Name CurrName,L.Remarks,L.Quantity,
		L.LDAlpha1,L.LDAlpha2,L.LDAlpha3,L.LDAlpha4,L.LDAlpha5,L.LDAlpha6,L.LDAlpha7,L.LDAlpha8,L.LDAlpha9,L.LDAlpha10,L.LDAlpha11,L.LDAlpha12,L.LDAlpha13,L.LDAlpha14,L.LDAlpha15,L.LDAlpha16,L.LDAlpha17,L.LDAlpha18,L.LDAlpha19,L.LDAlpha20
		,L.Alpha1,L.Alpha2,L.Alpha3,L.Alpha4,L.Alpha5,L.Alpha6,L.Alpha7,L.Alpha8,L.Alpha9,L.Alpha10,L.Alpha11,L.Alpha12,L.Alpha13,L.Alpha14,L.Alpha15,L.Alpha16,L.Alpha17
      ,L.Alpha18,L.Alpha19,L.Alpha20,L.Alpha21,L.Alpha22,L.Alpha23,L.Alpha24,L.Alpha25,L.Alpha26,L.Alpha27,L.Alpha28,L.Alpha29,L.Alpha30,L.Alpha31
      ,L.Alpha32,L.Alpha33,L.Alpha34,L.Alpha35,L.Alpha36,L.Alpha37,L.Alpha38,L.Alpha39,L.Alpha40,L.Alpha41,L.Alpha42
      ,L.Alpha43,L.Alpha44,L.Alpha45,L.Alpha46,L.Alpha47,L.Alpha48,L.Alpha49,L.Alpha50,
      L.CCNID1 as CCNID1_Key ,L.CCNID2 as CCNID2_Key ,L.CCNID3 as CCNID3_Key ,L.CCNID4 as CCNID4_Key ,L.CCNID5 as CCNID5_Key ,L.CCNID6 as CCNID6_Key ,L.CCNID7 as CCNID7_Key ,L.CCNID8 as CCNID8_Key ,L.CCNID9 as CCNID9_Key ,L.CCNID10 as CCNID10_Key ,L.CCNID11 as CCNID11_Key ,L.CCNID12 as CCNID12_Key ,L.CCNID13 as CCNID13_Key ,L.CCNID14 as CCNID14_Key ,L.CCNID15 as CCNID15_Key ,L.CCNID16 as CCNID16_Key ,
      L.CCNID17 as CCNID17_Key ,L.CCNID18 as CCNID18_Key ,L.CCNID19 as CCNID19_Key ,L.CCNID20 as CCNID20_Key ,L.CCNID21 as CCNID21_Key ,L.CCNID22 as CCNID22_Key ,L.CCNID23 as CCNID23_Key ,L.CCNID24 as CCNID24_Key ,L.CCNID25 as CCNID25_Key ,L.CCNID26 as CCNID26_Key ,L.CCNID27 as CCNID27_Key ,L.CCNID28 as CCNID28_Key ,L.CCNID29 as CCNID29_Key ,L.CCNID30 as CCNID30_Key ,
      L.CCNID31 as CCNID31_Key ,L.CCNID32 as CCNID32_Key ,L.CCNID33 as CCNID33_Key ,L.CCNID34 as CCNID34_Key ,L.CCNID35 as CCNID35_Key ,L.CCNID36 as CCNID36_Key ,L.CCNID37 as CCNID37_Key ,L.CCNID38 as CCNID38_Key ,L.CCNID39 as CCNID39_Key ,L.CCNID40 as CCNID40_Key ,L.CCNID41 as CCNID41_Key ,
      L.CCNID42 as CCNID42_Key,L.CCNID43 as CCNID43_Key ,L.CCNID44 as CCNID44_Key ,L.CCNID45 as CCNID45_Key ,L.CCNID46 as CCNID46_Key ,L.CCNID47 as CCNID47_Key ,L.CCNID48 as CCNID48_Key ,L.CCNID49 as CCNID49_Key ,L.CCNID50 as CCNID50_Key ,
	   NID1.NAME as CCNID1,NID2.NAME as CCNID2,NID3.NAME as CCNID3,NID4.NAME as CCNID4,NID5.NAME as CCNID5,NID6.NAME as CCNID6,NID7.NAME as CCNID7,NID8.NAME as CCNID8,NID9.NAME as CCNID9,NID10.NAME as CCNID10,
    	NID11.NAME as CCNID11,NID12.NAME as CCNID12,NID13.NAME as CCNID13,NID14.NAME as CCNID14,NID15.NAME as CCNID15,NID16.NAME as CCNID16,NID17.NAME as CCNID17,NID18.NAME as CCNID18,NID19.NAME as CCNID19,NID20.NAME as CCNID20,
		NID21.NAME as CCNID21,NID22.NAME as CCNID22,NID23.NAME as CCNID23,NID24.NAME as CCNID24,NID25.NAME as CCNID25,NID26.NAME as CCNID26,NID27.NAME as CCNID27,NID28.NAME as CCNID28,NID29.NAME as CCNID29,NID30.NAME as CCNID30,
		NID31.NAME as CCNID31,NID32.NAME as CCNID32,NID33.NAME as CCNID33,NID34.NAME as CCNID34,NID35.NAME as CCNID35,NID36.NAME as CCNID36,NID37.NAME as CCNID37,NID38.NAME as CCNID38,NID39.NAME as CCNID39,NID40.NAME as CCNID40,
		NID41.NAME as CCNID41,NID42.NAME as CCNID42,NID43.NAME as CCNID43,NID44.NAME as CCNID44,NID45.NAME as CCNID45,NID46.NAME as CCNID46,NID47.NAME as CCNID47,NID48.NAME as CCNID48,NID49.NAME as CCNID49,NID50.NAME as CCNID50 
		from CRM_ProductMapping L
		Left JOIN INV_Product P on P.ProductID = L.ProductID
		Left Join COM_UOM U on U.UOMID = L.UOMID
		Left Join COM_Currency CUR with(nolock) on CUR.CurrencyID = L.CurrencyID
		LEFT JOIN COM_DIVISION NID1 on L.CCNID1=NID1.NODEID
		LEFT JOIN COM_Location NID2 on L.CCNID2=NID2.NODEID
		LEFT JOIN COM_Branch NID3 on L.CCNID3=NID3.NODEID
		LEFT JOIN COM_Department NID4 on L.CCNID4=NID4.NODEID
		LEFT JOIN COM_Salesman NID5 on L.CCNID5=NID5.NODEID
		LEFT JOIN COM_Category NID6 on L.CCNID6=NID6.NODEID
		LEFT JOIN COM_Area NID7 on L.CCNID7=NID7.NODEID
		LEFT JOIN COM_Teritory NID8 on L.CCNID8=NID8.NODEID
		LEFT JOIN COM_CC50009 NID9 on L.CCNID9=NID9.NODEID
		LEFT JOIN COM_CC50010 NID10 on L.CCNID10=NID10.NODEID
		LEFT JOIN COM_CC50011 NID11 on L.CCNID11=NID11.NODEID
		LEFT JOIN COM_CC50012 NID12 on L.CCNID12=NID12.NODEID
		LEFT JOIN COM_CC50013 NID13 on L.CCNID13=NID13.NODEID
		LEFT JOIN COM_CC50014 NID14 on L.CCNID14=NID14.NODEID
		LEFT JOIN COM_CC50015 NID15 on L.CCNID15=NID15.NODEID
		LEFT JOIN COM_CC50016 NID16 on L.CCNID16=NID16.NODEID
		LEFT JOIN COM_CC50017 NID17 on L.CCNID17=NID17.NODEID
		LEFT JOIN COM_CC50018 NID18 on L.CCNID18=NID18.NODEID
		LEFT JOIN COM_CC50019 NID19 on L.CCNID19=NID19.NODEID 
		LEFT JOIN COM_CC50020 NID20 ON L.CCNID20=NID20.NODEID
		LEFT JOIN COM_CC50021 NID21 ON L.CCNID21=NID21.NODEID
		LEFT JOIN COM_CC50022 NID22 ON L.CCNID22=NID22.NODEID
		LEFT JOIN COM_CC50023 NID23 ON L.CCNID23=NID23.NODEID
		LEFT JOIN COM_CC50024 NID24 ON L.CCNID24=NID24.NODEID
		LEFT JOIN COM_CC50025 NID25 ON L.CCNID25=NID25.NODEID
		LEFT JOIN COM_CC50026 NID26 ON L.CCNID26=NID26.NODEID
		LEFT JOIN COM_CC50027 NID27 ON L.CCNID27=NID27.NODEID
		LEFT JOIN COM_CC50028 NID28 ON L.CCNID28=NID28.NODEID
		LEFT JOIN COM_CC50029 NID29 ON L.CCNID29=NID29.NODEID 
		LEFT JOIN COM_CC50030 NID30 ON L.CCNID30=NID30.NODEID
		LEFT JOIN COM_CC50031 NID31 ON L.CCNID31=NID31.NODEID
		LEFT JOIN COM_CC50032 NID32 ON L.CCNID32=NID32.NODEID
		LEFT JOIN COM_CC50033 NID33 ON L.CCNID33=NID33.NODEID
		LEFT JOIN COM_CC50034 NID34 ON L.CCNID34=NID34.NODEID
		LEFT JOIN COM_CC50035 NID35 ON L.CCNID35=NID35.NODEID
		LEFT JOIN COM_CC50036 NID36 ON L.CCNID36=NID36.NODEID
		LEFT JOIN COM_CC50037 NID37 ON L.CCNID37=NID37.NODEID
		LEFT JOIN COM_CC50038 NID38 ON L.CCNID38=NID38.NODEID
		LEFT JOIN COM_CC50039 NID39 ON L.CCNID39=NID39.NODEID 
		LEFT JOIN COM_CC50040 NID40 ON L.CCNID40=NID40.NODEID
		LEFT JOIN COM_CC50041 NID41 ON L.CCNID41=NID41.NODEID
		LEFT JOIN COM_CC50042 NID42 ON L.CCNID42=NID42.NODEID
		LEFT JOIN COM_CC50043 NID43 ON L.CCNID43=NID43.NODEID
		LEFT JOIN COM_CC50044 NID44 ON L.CCNID44=NID44.NODEID
		LEFT JOIN COM_CC50045 NID45 ON L.CCNID45=NID45.NODEID
		LEFT JOIN COM_CC50046 NID46 ON L.CCNID46=NID46.NODEID
		LEFT JOIN COM_CC50047 NID47 ON L.CCNID47=NID47.NODEID
		LEFT JOIN COM_CC50048 NID48 ON L.CCNID48=NID48.NODEID
		LEFT JOIN COM_CC50049 NID49 ON L.CCNID49=NID49.NODEID 
		LEFT JOIN COM_CC50050 NID50 ON L.CCNID50=NID50.NODEID
		where L.CCNodeID =  @CampaignID and CostCenterID=88




Select D.*   ,CON.Email1, 
NID1.NAME as NAME1,
NID2.NAME as NAME2,
NID3.NAME as NAME3,
NID4.NAME as NAME4,
NID5.NAME as NAME5,
NID6.NAME as NAME6,
NID7.NAME as NAME7,
NID8.NAME as NAME8,
NID9.NAME as NAME9,
NID10.NAME  AS NAME10,
NID11.NAME  AS NAME11,
NID12.NAME  AS NAME12,
NID13.NAME  AS NAME13,
NID14.NAME  AS NAME14,
NID15.NAME  AS NAME15,
NID16.NAME  AS NAME16,
NID17.NAME  AS NAME17,
NID18.NAME  AS NAME18,
NID19.NAME  AS NAME19,
NID20.NAME  AS NAME20,
NID21.NAME  AS NAME21,
NID22.NAME  AS NAME22,
NID23.NAME  AS NAME23,
NID24.NAME  AS NAME24,
NID25.NAME  AS NAME25,
NID26.NAME  AS NAME26,
NID27.NAME  AS NAME27,
NID28.NAME  AS NAME28,
NID29.NAME  AS NAME29,
NID30.NAME  AS NAME30,
NID31.NAME  AS NAME31,
NID32.NAME  AS NAME32,
NID33.NAME  AS NAME33,
NID34.NAME  AS NAME34,
NID35.NAME  AS NAME35,
NID36.NAME  AS NAME36,
NID37.NAME  AS NAME37,
NID38.NAME  AS NAME38,
NID39.NAME  AS NAME39,
NID40.NAME  AS NAME40,
NID41.NAME  AS NAME41,
NID42.NAME  AS NAME42,
NID43.NAME  AS NAME43,
NID44.NAME  AS NAME44,
NID45.NAME  AS NAME45,
NID46.NAME  AS NAME46,
NID47.NAME  AS NAME47,
NID48.NAME  AS NAME48,
NID49.NAME  AS NAME49,
NID50.NAME  AS NAME50 ,COM_Teritory.Name T,COM_DIVISION.Name D,Country.Name Co,City.Name Ci,
L.NAME AS SalutationName
from CRM_CampaignOrganization D WITH(NOLOCK) 
LEFT JOIN COM_CONTACTS CON ON CON.CONTACTID=D.ContactID
LEFT JOIN COM_LOOKUP L WITH(NOLOCK) 	ON D.SALUTATION=L.NODEID
LEFT JOIN COM_Teritory COM_Teritory WITH(NOLOCK) 	on D.Territory=COM_Teritory.NODEID
LEFT JOIN COM_DIVISION COM_DIVISION WITH(NOLOCK) 	on D.CytomedDivision=COM_DIVISION.NODEID
LEFT JOIN COM_CC50026 Country WITH(NOLOCK) 	ON D.Country=Country.NODEID
LEFT JOIN COM_CC50027 City WITH(NOLOCK) 	ON D.City=City.NODEID 
LEFT JOIN COM_DIVISION NID1 WITH(NOLOCK) 	on D.CCNID1=NID1.NODEID
LEFT JOIN COM_Location NID2 WITH(NOLOCK) 	on D.CCNID2=NID2.NODEID
LEFT JOIN COM_Branch NID3 WITH(NOLOCK) 	 on D.CCNID3=NID3.NODEID
LEFT JOIN COM_Department NID4 WITH(NOLOCK) 	on D.CCNID4=NID4.NODEID
LEFT JOIN COM_Salesman NID5 WITH(NOLOCK) 	on D.CCNID5=NID5.NODEID
LEFT JOIN COM_Category NID6 WITH(NOLOCK) 	on D.CCNID6=NID6.NODEID
LEFT JOIN COM_Area NID7 WITH(NOLOCK) 	on D.CCNID7=NID7.NODEID
LEFT JOIN COM_Teritory NID8 WITH(NOLOCK) 	on D.CCNID8=NID8.NODEID
LEFT JOIN COM_CC50009 NID9 WITH(NOLOCK) 	on D.CCNID9=NID9.NODEID
LEFT JOIN COM_CC50010 NID10 WITH(NOLOCK) 	on D.CCNID10=NID10.NODEID
LEFT JOIN COM_CC50011 NID11 WITH(NOLOCK) 	on D.CCNID11=NID11.NODEID
LEFT JOIN COM_CC50012 NID12 WITH(NOLOCK) 	on D.CCNID12=NID12.NODEID
LEFT JOIN COM_CC50013 NID13 WITH(NOLOCK) 	on D.CCNID13=NID13.NODEID
LEFT JOIN COM_CC50014 NID14 WITH(NOLOCK) 	on D.CCNID14=NID14.NODEID
LEFT JOIN COM_CC50015 NID15 WITH(NOLOCK) 	on D.CCNID15=NID15.NODEID
LEFT JOIN COM_CC50016 NID16 WITH(NOLOCK) 	on D.CCNID16=NID16.NODEID
LEFT JOIN COM_CC50017 NID17 WITH(NOLOCK) 	on D.CCNID17=NID17.NODEID
LEFT JOIN COM_CC50018 NID18 WITH(NOLOCK) 	on D.CCNID18=NID18.NODEID
LEFT JOIN COM_CC50019 NID19 WITH(NOLOCK) 	on D.CCNID19=NID19.NODEID 
LEFT JOIN COM_CC50020 NID20 WITH(NOLOCK) 	ON D.CCNID20=NID20.NODEID
LEFT JOIN COM_CC50021 NID21 WITH(NOLOCK) 	ON D.CCNID21=NID21.NODEID
LEFT JOIN COM_CC50022 NID22 WITH(NOLOCK) 	ON D.CCNID22=NID22.NODEID
LEFT JOIN COM_CC50023 NID23 WITH(NOLOCK) 	ON D.CCNID23=NID23.NODEID
LEFT JOIN COM_CC50024 NID24 WITH(NOLOCK) 	ON D.CCNID24=NID24.NODEID
LEFT JOIN COM_CC50025 NID25 WITH(NOLOCK) 	ON D.CCNID25=NID25.NODEID
LEFT JOIN COM_CC50026 NID26 WITH(NOLOCK) 	ON D.CCNID26=NID26.NODEID
LEFT JOIN COM_CC50027 NID27 WITH(NOLOCK) 	ON D.CCNID27=NID27.NODEID
LEFT JOIN COM_CC50028 NID28 WITH(NOLOCK) 	ON D.CCNID28=NID28.NODEID
LEFT JOIN COM_CC50029 NID29 WITH(NOLOCK) 	ON D.CCNID29=NID29.NODEID 
LEFT JOIN COM_CC50030 NID30 WITH(NOLOCK) 	ON D.CCNID30=NID30.NODEID
LEFT JOIN COM_CC50031 NID31 WITH(NOLOCK) 	ON D.CCNID31=NID31.NODEID
LEFT JOIN COM_CC50032 NID32 WITH(NOLOCK) 	ON D.CCNID32=NID32.NODEID
LEFT JOIN COM_CC50033 NID33 WITH(NOLOCK) 	ON D.CCNID33=NID33.NODEID
LEFT JOIN COM_CC50034 NID34 WITH(NOLOCK) 	ON D.CCNID34=NID34.NODEID
LEFT JOIN COM_CC50035 NID35 WITH(NOLOCK) 	ON D.CCNID35=NID35.NODEID
LEFT JOIN COM_CC50036 NID36 WITH(NOLOCK) 	ON D.CCNID36=NID36.NODEID
LEFT JOIN COM_CC50037 NID37 WITH(NOLOCK) 	ON D.CCNID37=NID37.NODEID
LEFT JOIN COM_CC50038 NID38 WITH(NOLOCK) 	ON D.CCNID38=NID38.NODEID
LEFT JOIN COM_CC50039 NID39 WITH(NOLOCK) 	ON D.CCNID39=NID39.NODEID 
LEFT JOIN COM_CC50040 NID40 WITH(NOLOCK) 	ON D.CCNID40=NID40.NODEID
LEFT JOIN COM_CC50041 NID41 WITH(NOLOCK) 	ON D.CCNID41=NID41.NODEID
LEFT JOIN COM_CC50042 NID42 WITH(NOLOCK) 	ON D.CCNID42=NID42.NODEID
LEFT JOIN COM_CC50043 NID43 WITH(NOLOCK) 	ON D.CCNID43=NID43.NODEID
LEFT JOIN COM_CC50044 NID44 WITH(NOLOCK) 	ON D.CCNID44=NID44.NODEID
LEFT JOIN COM_CC50045 NID45 WITH(NOLOCK) 	ON D.CCNID45=NID45.NODEID
LEFT JOIN COM_CC50046 NID46 WITH(NOLOCK) 	ON D.CCNID46=NID46.NODEID
LEFT JOIN COM_CC50047 NID47 WITH(NOLOCK) 	ON D.CCNID47=NID47.NODEID
LEFT JOIN COM_CC50048 NID48 WITH(NOLOCK) 	ON D.CCNID48=NID48.NODEID
LEFT JOIN COM_CC50049 NID49 WITH(NOLOCK) 	ON D.CCNID49=NID49.NODEID 
LEFT JOIN COM_CC50050 NID50 WITH(NOLOCK) 	ON D.CCNID50=NID50.NODEID
where CampaignNodeID=@CampaignID

SELECT * FROM [CRM_CampaignsExtended] WITH(NOLOCK) WHERE CAMPAIGNID=@CampaignID

SELECT [CRM_CampaignStaff].*,CON.Email1   FROM [CRM_CampaignStaff] WITH(NOLOCK)
LEFT JOIN COM_CONTACTS CON ON CON.CONTACTID=[CRM_CampaignStaff].CONTACTID
 WHERE CAMPAIGNID=@CampaignID

Select D.*,convert(datetime,D.date) d ,
NID1.NAME as NAME1,
NID2.NAME as NAME2,
NID3.NAME as NAME3,
NID4.NAME as NAME4,
NID5.NAME as NAME5,
NID6.NAME as NAME6,
NID7.NAME as NAME7,
NID8.NAME as NAME8,
NID9.NAME as NAME9,
NID10.NAME  AS NAME10,
NID11.NAME  AS NAME11,
NID12.NAME  AS NAME12,
NID13.NAME  AS NAME13,
NID14.NAME  AS NAME14,
NID15.NAME  AS NAME15,
NID16.NAME  AS NAME16,
NID17.NAME  AS NAME17,
NID18.NAME  AS NAME18,
NID19.NAME  AS NAME19,
NID20.NAME  AS NAME20,
NID21.NAME  AS NAME21,
NID22.NAME  AS NAME22,
NID23.NAME  AS NAME23,
NID24.NAME  AS NAME24,
NID25.NAME  AS NAME25,
NID26.NAME  AS NAME26,
NID27.NAME  AS NAME27,
NID28.NAME  AS NAME28,
NID29.NAME  AS NAME29,
NID30.NAME  AS NAME30,
NID31.NAME  AS NAME31,
NID32.NAME  AS NAME32,
NID33.NAME  AS NAME33,
NID34.NAME  AS NAME34,
NID35.NAME  AS NAME35,
NID36.NAME  AS NAME36,
NID37.NAME  AS NAME37,
NID38.NAME  AS NAME38,
NID39.NAME  AS NAME39,
NID40.NAME  AS NAME40,
NID41.NAME  AS NAME41,
NID42.NAME  AS NAME42,
NID43.NAME  AS NAME43,
NID44.NAME  AS NAME44,
NID45.NAME  AS NAME45,
NID46.NAME  AS NAME46,
NID47.NAME  AS NAME47,
NID48.NAME  AS NAME48,
NID49.NAME  AS NAME49,
NID50.NAME  AS NAME50  
from CRM_CampaignApprovals D WITH(NOLOCK) 	
LEFT JOIN COM_DIVISION NID1 WITH(NOLOCK) 	on D.CCNID1=NID1.NODEID
LEFT JOIN COM_Location NID2 WITH(NOLOCK) 	on D.CCNID2=NID2.NODEID
LEFT JOIN COM_Branch NID3 WITH(NOLOCK) 	on D.CCNID3=NID3.NODEID
LEFT JOIN COM_Department NID4 WITH(NOLOCK) 	on D.CCNID4=NID4.NODEID
LEFT JOIN COM_Salesman NID5 WITH(NOLOCK) 	on D.CCNID5=NID5.NODEID
LEFT JOIN COM_Category NID6 WITH(NOLOCK) 	on D.CCNID6=NID6.NODEID
LEFT JOIN COM_Area NID7 WITH(NOLOCK) 	on D.CCNID7=NID7.NODEID
LEFT JOIN COM_Teritory NID8 WITH(NOLOCK) 	on D.CCNID8=NID8.NODEID
LEFT JOIN COM_CC50009 NID9 WITH(NOLOCK) 	on D.CCNID9=NID9.NODEID
LEFT JOIN COM_CC50010 NID10 WITH(NOLOCK) 	on D.CCNID10=NID10.NODEID
LEFT JOIN COM_CC50011 NID11 WITH(NOLOCK) 	on D.CCNID11=NID11.NODEID
LEFT JOIN COM_CC50012 NID12 WITH(NOLOCK) 	on D.CCNID12=NID12.NODEID
LEFT JOIN COM_CC50013 NID13 WITH(NOLOCK) 	on D.CCNID13=NID13.NODEID
LEFT JOIN COM_CC50014 NID14 WITH(NOLOCK) 	on D.CCNID14=NID14.NODEID
LEFT JOIN COM_CC50015 NID15 WITH(NOLOCK) 	on D.CCNID15=NID15.NODEID
LEFT JOIN COM_CC50016 NID16 WITH(NOLOCK) 	on D.CCNID16=NID16.NODEID
LEFT JOIN COM_CC50017 NID17 WITH(NOLOCK) 	 on D.CCNID17=NID17.NODEID
LEFT JOIN COM_CC50018 NID18 WITH(NOLOCK) 	on D.CCNID18=NID18.NODEID
LEFT JOIN COM_CC50019 NID19 WITH(NOLOCK) 	on D.CCNID19=NID19.NODEID 
LEFT JOIN COM_CC50020 NID20 WITH(NOLOCK) 	ON D.CCNID20=NID20.NODEID
LEFT JOIN COM_CC50021 NID21 WITH(NOLOCK) 	ON D.CCNID21=NID21.NODEID
LEFT JOIN COM_CC50022 NID22 WITH(NOLOCK) 	ON D.CCNID22=NID22.NODEID
LEFT JOIN COM_CC50023 NID23 WITH(NOLOCK) 	ON D.CCNID23=NID23.NODEID
LEFT JOIN COM_CC50024 NID24 WITH(NOLOCK) 	ON D.CCNID24=NID24.NODEID
LEFT JOIN COM_CC50025 NID25 WITH(NOLOCK) 	ON D.CCNID25=NID25.NODEID
LEFT JOIN COM_CC50026 NID26 WITH(NOLOCK) 	ON D.CCNID26=NID26.NODEID
LEFT JOIN COM_CC50027 NID27 WITH(NOLOCK) 	ON D.CCNID27=NID27.NODEID
LEFT JOIN COM_CC50028 NID28 WITH(NOLOCK) 	ON D.CCNID28=NID28.NODEID
LEFT JOIN COM_CC50029 NID29 WITH(NOLOCK) 	ON D.CCNID29=NID29.NODEID 
LEFT JOIN COM_CC50030 NID30 WITH(NOLOCK) 	ON D.CCNID30=NID30.NODEID
LEFT JOIN COM_CC50031 NID31 WITH(NOLOCK) 	ON D.CCNID31=NID31.NODEID
LEFT JOIN COM_CC50032 NID32 WITH(NOLOCK) 	ON D.CCNID32=NID32.NODEID
LEFT JOIN COM_CC50033 NID33 WITH(NOLOCK) 	ON D.CCNID33=NID33.NODEID
LEFT JOIN COM_CC50034 NID34 WITH(NOLOCK) 	ON D.CCNID34=NID34.NODEID
LEFT JOIN COM_CC50035 NID35 WITH(NOLOCK) 	ON D.CCNID35=NID35.NODEID
LEFT JOIN COM_CC50036 NID36 WITH(NOLOCK) 	ON D.CCNID36=NID36.NODEID
LEFT JOIN COM_CC50037 NID37 WITH(NOLOCK) 	ON D.CCNID37=NID37.NODEID
LEFT JOIN COM_CC50038 NID38 WITH(NOLOCK) 	ON D.CCNID38=NID38.NODEID
LEFT JOIN COM_CC50039 NID39 WITH(NOLOCK) 	ON D.CCNID39=NID39.NODEID 
LEFT JOIN COM_CC50040 NID40 WITH(NOLOCK) 	ON D.CCNID40=NID40.NODEID
LEFT JOIN COM_CC50041 NID41 WITH(NOLOCK) 	ON D.CCNID41=NID41.NODEID
LEFT JOIN COM_CC50042 NID42 WITH(NOLOCK) 	ON D.CCNID42=NID42.NODEID
LEFT JOIN COM_CC50043 NID43 WITH(NOLOCK) 	ON D.CCNID43=NID43.NODEID
LEFT JOIN COM_CC50044 NID44 WITH(NOLOCK) 	ON D.CCNID44=NID44.NODEID
LEFT JOIN COM_CC50045 NID45 WITH(NOLOCK) 	ON D.CCNID45=NID45.NODEID
LEFT JOIN COM_CC50046 NID46 WITH(NOLOCK) 	ON D.CCNID46=NID46.NODEID
LEFT JOIN COM_CC50047 NID47 WITH(NOLOCK) 	ON D.CCNID47=NID47.NODEID
LEFT JOIN COM_CC50048 NID48 WITH(NOLOCK) 	ON D.CCNID48=NID48.NODEID
LEFT JOIN COM_CC50049 NID49 WITH(NOLOCK) 	ON D.CCNID49=NID49.NODEID 
LEFT JOIN COM_CC50050 NID50 WITH(NOLOCK) 	ON D.CCNID50=NID50.NODEID
where campaignNodeID=@CampaignID


		--Getting Notes
		SELECT     NoteID, Note, FeatureID, FeaturePK, CompanyGUID, GUID, CreatedBy, convert(datetime,CreatedDate) as CreatedDate, 
		ModifiedBy, ModifiedDate, CostCenterID
		FROM         COM_Notes WITH(NOLOCK) 
		WHERE FeatureID=88 and  FeaturePK=@CampaignID
			 
		
		--Getting Files
		SELECT * FROM  COM_Files WITH(NOLOCK) 
		WHERE FeatureID=88 and  FeaturePK=@CampaignID

		--Getting Venue details
		select * from com_lookup where lookuptype=59
		
		Select D.*,CON.Email1, convert(datetime,D.date) d ,
NID1.NAME as NAME1,NID2.NAME as NAME2,NID3.NAME as NAME3,NID4.NAME as NAME4,NID5.NAME as NAME5,NID6.NAME as NAME6,NID7.NAME as NAME7,NID8.NAME as NAME8,NID9.NAME as NAME9,NID10.NAME  AS NAME10,
NID11.NAME  AS NAME11,NID12.NAME  AS NAME12,NID13.NAME  AS NAME13,NID14.NAME  AS NAME14,NID15.NAME  AS NAME15,NID16.NAME  AS NAME16,NID17.NAME  AS NAME17,NID18.NAME  AS NAME18,NID19.NAME  AS NAME19,NID20.NAME  AS NAME20,
NID21.NAME  AS NAME21,NID22.NAME  AS NAME22,NID23.NAME  AS NAME23,NID24.NAME  AS NAME24,NID25.NAME  AS NAME25,NID26.NAME  AS NAME26,NID27.NAME  AS NAME27,NID28.NAME  AS NAME28,NID29.NAME  AS NAME29,NID30.NAME  AS NAME30,
NID31.NAME  AS NAME31,NID32.NAME  AS NAME32,NID33.NAME  AS NAME33,NID34.NAME  AS NAME34,NID35.NAME  AS NAME35,NID36.NAME  AS NAME36,NID37.NAME  AS NAME37,NID38.NAME  AS NAME38,NID39.NAME  AS NAME39,NID40.NAME  AS NAME40,
NID41.NAME  AS NAME41,NID42.NAME  AS NAME42,NID43.NAME  AS NAME43,NID44.NAME  AS NAME44,NID45.NAME  AS NAME45,NID46.NAME  AS NAME46,NID47.NAME  AS NAME47,NID48.NAME  AS NAME48,NID49.NAME  AS NAME49,NID50.NAME  AS NAME50  
from CRM_CampaignSpeakers D
LEFT JOIN COM_DIVISION NID1 on D.CCNID1=NID1.NODEID LEFT JOIN COM_Location NID2 on D.CCNID2=NID2.NODEID LEFT JOIN COM_Branch NID3 on D.CCNID3=NID3.NODEID LEFT JOIN COM_Department NID4 on D.CCNID4=NID4.NODEID LEFT JOIN COM_Salesman NID5 on D.CCNID5=NID5.NODEID
LEFT JOIN COM_Category NID6 on D.CCNID6=NID6.NODEID LEFT JOIN COM_Area NID7 on D.CCNID7=NID7.NODEID LEFT JOIN COM_Teritory NID8 on D.CCNID8=NID8.NODEID LEFT JOIN COM_CC50009 NID9 on D.CCNID9=NID9.NODEID LEFT JOIN COM_CC50010 NID10 on D.CCNID10=NID10.NODEID
LEFT JOIN COM_CC50011 NID11 on D.CCNID11=NID11.NODEID LEFT JOIN COM_CC50012 NID12 on D.CCNID12=NID12.NODEID LEFT JOIN COM_CC50013 NID13 on D.CCNID13=NID13.NODEID LEFT JOIN COM_CC50014 NID14 on D.CCNID14=NID14.NODEID LEFT JOIN COM_CC50015 NID15 on D.CCNID15=NID15.NODEID 
LEFT JOIN COM_CC50016 NID16 on D.CCNID16=NID16.NODEID LEFT JOIN COM_CC50017 NID17 on D.CCNID17=NID17.NODEID LEFT JOIN COM_CC50018 NID18 on D.CCNID18=NID18.NODEID LEFT JOIN COM_CC50019 NID19 on D.CCNID19=NID19.NODEID LEFT JOIN COM_CC50020 NID20 ON D.CCNID20=NID20.NODEID
LEFT JOIN COM_CC50021 NID21 ON D.CCNID21=NID21.NODEID LEFT JOIN COM_CC50022 NID22 ON D.CCNID22=NID22.NODEID LEFT JOIN COM_CC50023 NID23 ON D.CCNID23=NID23.NODEID LEFT JOIN COM_CC50024 NID24 ON D.CCNID24=NID24.NODEID LEFT JOIN COM_CC50025 NID25 ON D.CCNID25=NID25.NODEID 
LEFT JOIN COM_CC50026 NID26 ON D.CCNID26=NID26.NODEID LEFT JOIN COM_CC50027 NID27 ON D.CCNID27=NID27.NODEID LEFT JOIN COM_CC50028 NID28 ON D.CCNID28=NID28.NODEID LEFT JOIN COM_CC50029 NID29 ON D.CCNID29=NID29.NODEID LEFT JOIN COM_CC50030 NID30 ON D.CCNID30=NID30.NODEID
LEFT JOIN COM_CC50031 NID31 ON D.CCNID31=NID31.NODEID LEFT JOIN COM_CC50032 NID32 ON D.CCNID32=NID32.NODEID LEFT JOIN COM_CC50033 NID33 ON D.CCNID33=NID33.NODEID LEFT JOIN COM_CC50034 NID34 ON D.CCNID34=NID34.NODEID LEFT JOIN COM_CC50035 NID35 ON D.CCNID35=NID35.NODEID
LEFT JOIN COM_CC50036 NID36 ON D.CCNID36=NID36.NODEID LEFT JOIN COM_CC50037 NID37 ON D.CCNID37=NID37.NODEID LEFT JOIN COM_CC50038 NID38 ON D.CCNID38=NID38.NODEID LEFT JOIN COM_CC50039 NID39 ON D.CCNID39=NID39.NODEID  LEFT JOIN COM_CC50040 NID40 ON D.CCNID40=NID40.NODEID
LEFT JOIN COM_CC50041 NID41 ON D.CCNID41=NID41.NODEID LEFT JOIN COM_CC50042 NID42 ON D.CCNID42=NID42.NODEID LEFT JOIN COM_CC50043 NID43 ON D.CCNID43=NID43.NODEID LEFT JOIN COM_CC50044 NID44 ON D.CCNID44=NID44.NODEID LEFT JOIN COM_CC50045 NID45 ON D.CCNID45=NID45.NODEID
LEFT JOIN COM_CC50046 NID46 ON D.CCNID46=NID46.NODEID LEFT JOIN COM_CC50047 NID47 ON D.CCNID47=NID47.NODEID LEFT JOIN COM_CC50048 NID48 ON D.CCNID48=NID48.NODEID LEFT JOIN COM_CC50049 NID49 ON D.CCNID49=NID49.NODEID  LEFT JOIN COM_CC50050 NID50 ON D.CCNID50=NID50.NODEID
LEFT JOIN COM_CONTACTS CON ON CON.CONTACTID=D.CONTACTID
where campaignNodeID=@CampaignID

SELECT ConvertFromCampaignID FROM CRM_Opportunities WITH(nolock) WHERE ConvertFromCampaignID=@CampaignID
SELECT ConvertFromCampaignID FROM CRM_LEADS WITH(nolock) WHERE ConvertFromCampaignID=@CampaignID

	 IF(EXISTS(SELECT * FROM CRM_Activities WHERE CostCenterID=88 AND NodeID=@CampaignID))
			EXEC spCRM_GetFeatureByActvities @CampaignID,88,'',@UserID,@LangID  
		ELSE
			SELECT 1 WHERE 1<>1
			


Select D.*   ,CON.Email1, NID1.NAME as NAME1,NID2.NAME as NAME2,NID3.NAME as NAME3,NID4.NAME as NAME4,NID5.NAME as NAME5,NID6.NAME as NAME6,NID7.NAME as NAME7,
NID8.NAME as NAME8,NID9.NAME as NAME9,NID10.NAME  AS NAME10,NID11.NAME  AS NAME11,NID12.NAME  AS NAME12,NID13.NAME  AS NAME13,NID14.NAME  AS NAME14,NID15.NAME  AS NAME15,
NID16.NAME  AS NAME16,NID17.NAME  AS NAME17,NID18.NAME  AS NAME18,NID19.NAME  AS NAME19,NID20.NAME  AS NAME20,NID21.NAME  AS NAME21,NID22.NAME  AS NAME22,
NID23.NAME  AS NAME23,NID24.NAME  AS NAME24,NID25.NAME  AS NAME25,NID26.NAME  AS NAME26,NID27.NAME  AS NAME27,NID28.NAME  AS NAME28,NID29.NAME  AS NAME29,NID30.NAME  AS NAME30,
NID31.NAME  AS NAME31,NID32.NAME  AS NAME32,NID33.NAME  AS NAME33,NID34.NAME  AS NAME34,NID35.NAME  AS NAME35,NID36.NAME  AS NAME36,NID37.NAME  AS NAME37,
NID38.NAME  AS NAME38,NID39.NAME  AS NAME39,NID40.NAME  AS NAME40,NID41.NAME  AS NAME41,NID42.NAME  AS NAME42,NID43.NAME  AS NAME43,NID44.NAME  AS NAME44,
NID45.NAME  AS NAME45,NID46.NAME  AS NAME46,NID47.NAME  AS NAME47,NID48.NAME  AS NAME48,NID49.NAME  AS NAME49,NID50.NAME  AS NAME50 ,COM_Teritory.Name T,COM_DIVISION.Name D,Country.Name Co,City.Name Ci,L.NAME AS SalutationName
from CRM_CampaignInvites D WITH(NOLOCK) LEFT JOIN COM_CONTACTS CON ON CON.CONTACTID=D.ContactID LEFT JOIN COM_LOOKUP L WITH(NOLOCK) 	ON D.SALUTATION=L.NODEID
LEFT JOIN COM_Teritory COM_Teritory WITH(NOLOCK) 	on D.Territory=COM_Teritory.NODEID LEFT JOIN COM_DIVISION COM_DIVISION WITH(NOLOCK) 	on D.CytomedDivision=COM_DIVISION.NODEID LEFT JOIN COM_CC50026 Country WITH(NOLOCK) 	ON D.Country=Country.NODEID
LEFT JOIN COM_CC50027 City WITH(NOLOCK) 	ON D.City=City.NODEID LEFT JOIN COM_DIVISION NID1 WITH(NOLOCK) 	on D.CCNID1=NID1.NODEID LEFT JOIN COM_Location NID2 WITH(NOLOCK) 	on D.CCNID2=NID2.NODEID
LEFT JOIN COM_Branch NID3 WITH(NOLOCK) 	 on D.CCNID3=NID3.NODEID LEFT JOIN COM_Department NID4 WITH(NOLOCK) 	on D.CCNID4=NID4.NODEID LEFT JOIN COM_Salesman NID5 WITH(NOLOCK) 	on D.CCNID5=NID5.NODEID
LEFT JOIN COM_Category NID6 WITH(NOLOCK) 	on D.CCNID6=NID6.NODEID LEFT JOIN COM_Area NID7 WITH(NOLOCK) 	on D.CCNID7=NID7.NODEID LEFT JOIN COM_Teritory NID8 WITH(NOLOCK) 	on D.CCNID8=NID8.NODEID
LEFT JOIN COM_CC50009 NID9 WITH(NOLOCK) 	on D.CCNID9=NID9.NODEID LEFT JOIN COM_CC50010 NID10 WITH(NOLOCK) 	on D.CCNID10=NID10.NODEID LEFT JOIN COM_CC50011 NID11 WITH(NOLOCK) 	on D.CCNID11=NID11.NODEID
LEFT JOIN COM_CC50012 NID12 WITH(NOLOCK) 	on D.CCNID12=NID12.NODEID LEFT JOIN COM_CC50013 NID13 WITH(NOLOCK) 	on D.CCNID13=NID13.NODEID LEFT JOIN COM_CC50014 NID14 WITH(NOLOCK) 	on D.CCNID14=NID14.NODEID
LEFT JOIN COM_CC50015 NID15 WITH(NOLOCK) 	on D.CCNID15=NID15.NODEID LEFT JOIN COM_CC50016 NID16 WITH(NOLOCK) 	on D.CCNID16=NID16.NODEID LEFT JOIN COM_CC50017 NID17 WITH(NOLOCK) 	on D.CCNID17=NID17.NODEID
LEFT JOIN COM_CC50018 NID18 WITH(NOLOCK) 	on D.CCNID18=NID18.NODEID LEFT JOIN COM_CC50019 NID19 WITH(NOLOCK) 	on D.CCNID19=NID19.NODEID  LEFT JOIN COM_CC50020 NID20 WITH(NOLOCK) 	ON D.CCNID20=NID20.NODEID
LEFT JOIN COM_CC50021 NID21 WITH(NOLOCK) 	ON D.CCNID21=NID21.NODEID LEFT JOIN COM_CC50022 NID22 WITH(NOLOCK) 	ON D.CCNID22=NID22.NODEID LEFT JOIN COM_CC50023 NID23 WITH(NOLOCK) 	ON D.CCNID23=NID23.NODEID
LEFT JOIN COM_CC50024 NID24 WITH(NOLOCK) 	ON D.CCNID24=NID24.NODEID LEFT JOIN COM_CC50025 NID25 WITH(NOLOCK) 	ON D.CCNID25=NID25.NODEID LEFT JOIN COM_CC50026 NID26 WITH(NOLOCK) 	ON D.CCNID26=NID26.NODEID
LEFT JOIN COM_CC50027 NID27 WITH(NOLOCK) 	ON D.CCNID27=NID27.NODEID LEFT JOIN COM_CC50028 NID28 WITH(NOLOCK) 	ON D.CCNID28=NID28.NODEID LEFT JOIN COM_CC50029 NID29 WITH(NOLOCK) 	ON D.CCNID29=NID29.NODEID 
LEFT JOIN COM_CC50030 NID30 WITH(NOLOCK) 	ON D.CCNID30=NID30.NODEID LEFT JOIN COM_CC50031 NID31 WITH(NOLOCK) 	ON D.CCNID31=NID31.NODEID LEFT JOIN COM_CC50032 NID32 WITH(NOLOCK) 	ON D.CCNID32=NID32.NODEID
LEFT JOIN COM_CC50033 NID33 WITH(NOLOCK) 	ON D.CCNID33=NID33.NODEID LEFT JOIN COM_CC50034 NID34 WITH(NOLOCK) 	ON D.CCNID34=NID34.NODEID LEFT JOIN COM_CC50035 NID35 WITH(NOLOCK) 	ON D.CCNID35=NID35.NODEID
LEFT JOIN COM_CC50036 NID36 WITH(NOLOCK) 	ON D.CCNID36=NID36.NODEID LEFT JOIN COM_CC50037 NID37 WITH(NOLOCK) 	ON D.CCNID37=NID37.NODEID LEFT JOIN COM_CC50038 NID38 WITH(NOLOCK) 	ON D.CCNID38=NID38.NODEID
LEFT JOIN COM_CC50039 NID39 WITH(NOLOCK) 	ON D.CCNID39=NID39.NODEID LEFT JOIN COM_CC50040 NID40 WITH(NOLOCK) 	ON D.CCNID40=NID40.NODEID LEFT JOIN COM_CC50041 NID41 WITH(NOLOCK) 	ON D.CCNID41=NID41.NODEID
LEFT JOIN COM_CC50042 NID42 WITH(NOLOCK) 	ON D.CCNID42=NID42.NODEID LEFT JOIN COM_CC50043 NID43 WITH(NOLOCK) 	ON D.CCNID43=NID43.NODEID LEFT JOIN COM_CC50044 NID44 WITH(NOLOCK) 	ON D.CCNID44=NID44.NODEID
LEFT JOIN COM_CC50045 NID45 WITH(NOLOCK) 	ON D.CCNID45=NID45.NODEID LEFT JOIN COM_CC50046 NID46 WITH(NOLOCK) 	ON D.CCNID46=NID46.NODEID LEFT JOIN COM_CC50047 NID47 WITH(NOLOCK) 	ON D.CCNID47=NID47.NODEID
LEFT JOIN COM_CC50048 NID48 WITH(NOLOCK) 	ON D.CCNID48=NID48.NODEID LEFT JOIN COM_CC50049 NID49 WITH(NOLOCK) 	ON D.CCNID49=NID49.NODEID LEFT JOIN COM_CC50050 NID50 WITH(NOLOCK) 	ON D.CCNID50=NID50.NODEID
where CampaignNodeID=@CampaignID


SELECT     L.CampaignID, A.ActivityID, A.ActivityTypeID, A.ScheduleID, A.CostCenterID, A.NodeID, A.StatusID AS ActStatus, A.Subject AS ActSubject, A.Priority, 
                      A.PctComplete, A.Location, A.IsAllDayActivity,  CONVERT(datetime, A.ActualCloseDate) AS ActualCloseDate, A.ActualCloseTime, A.CustomerID, 
                      A.Remarks, A.AssignUserID, A.AssignRoleID, A.AssignGroupID,CONVERT(datetime, A.StartDate) AS ActStartDate, 
                      CONVERT(datetime, A.EndDate) AS ActEndDate,  A.StartTime AS ActStartTime, A.EndTime AS ActEndTime, S.ScheduleID AS Expr10, S.Name, S.StatusID AS Expr11, S.FreqType, S.FreqInterval, 
                      S.FreqSubdayType, S.FreqSubdayInterval, S.FreqRelativeInterval, S.FreqRecurrenceFactor, CONVERT(datetime, S.StartDate) AS CStartDate, 
                      CONVERT(datetime, S.EndDate) AS CEndDate, CONVERT(datetime, S.StartTime) AS StartTime, CONVERT(datetime, S.EndTime) AS EndTime, 
                      S.Message,case when A.ActivityTypeID=1 then 'AppointmentRegular' 
					             when A.ActivityTypeID=2 then 'TaskRegular' 
							     when A.ActivityTypeID=3 then 'ApptRecurring' 
								 when A.ActivityTypeID=4 then 'TaskRecur' end as Activity ,[Alpha1],[Alpha2],[Alpha3],[Alpha4],[Alpha5],[Alpha6],[Alpha7],[Alpha8],[Alpha9],[Alpha10],[Alpha11],[Alpha12],[Alpha13],[Alpha14][Alpha15],[Alpha16],[Alpha17]
      ,[Alpha18],[Alpha19],[Alpha20],[Alpha21],[Alpha22],[Alpha23],[Alpha24],[Alpha25],[Alpha26],[Alpha27],[Alpha28],[Alpha29],[Alpha30],[Alpha31]
      ,[Alpha32],[Alpha33],[Alpha34],[Alpha35],[Alpha36],[Alpha37],[Alpha38],[Alpha39],[Alpha40],[Alpha41],[Alpha42]
      ,[Alpha43],[Alpha44],[Alpha45],[Alpha46],[Alpha47],[Alpha48],[Alpha49],[Alpha50],[CCNID1] as CCNID1_Key ,[CCNID2] as CCNID2_Key ,[CCNID3] as CCNID3_Key ,[CCNID4] as CCNID4_Key ,[CCNID5] as CCNID5_Key ,[CCNID6] as CCNID6_Key ,[CCNID7] as CCNID7_Key ,[CCNID8] as CCNID8_Key ,[CCNID9] as CCNID9_Key ,[CCNID10] as CCNID10_Key ,[CCNID11] as CCNID11_Key ,[CCNID12] as CCNID12_Key ,[CCNID13] as CCNID13_Key ,[CCNID14] as CCNID14_Key ,[CCNID15] as CCNID15_Key ,[CCNID16] as CCNID16_Key ,
      [CCNID17] as CCNID17_Key ,[CCNID18] as CCNID18_Key ,[CCNID19] as CCNID19_Key ,[CCNID20] as CCNID20_Key ,[CCNID21] as CCNID21_Key ,[CCNID22] as CCNID22_Key ,[CCNID23] as CCNID23_Key ,[CCNID24] as CCNID24_Key ,[CCNID25] as CCNID25_Key ,[CCNID26] as CCNID26_Key ,[CCNID27] as CCNID27_Key ,[CCNID28] as CCNID28_Key ,[CCNID29] as CCNID29_Key ,[CCNID30] as CCNID30_Key ,
      [CCNID31] as CCNID31_Key ,[CCNID32] as CCNID32_Key ,[CCNID33] as CCNID33_Key ,[CCNID34] as CCNID34_Key ,[CCNID35] as CCNID35_Key ,[CCNID36] as CCNID36_Key ,[CCNID37] as CCNID37_Key ,[CCNID38] as CCNID38_Key ,[CCNID39] as CCNID39_Key ,[CCNID40] as CCNID40_Key ,[CCNID41] as CCNID41_Key ,
      [CCNID42] as CCNID42_Key,[CCNID43] as CCNID43_Key ,[CCNID44] as CCNID44_Key ,[CCNID45] as CCNID45_Key ,[CCNID46] as CCNID46_Key ,[CCNID47] as CCNID47_Key ,[CCNID48] as CCNID48_Key ,[CCNID49] as CCNID49_Key ,[CCNID50] as CCNID50_Key ,
	   NID1.NAME as CCNID1,NID2.NAME as CCNID2,NID3.NAME as CCNID3,NID4.NAME as CCNID4,NID5.NAME as CCNID5,NID6.NAME as CCNID6,NID7.NAME as CCNID7,NID8.NAME as CCNID8,NID9.NAME as CCNID9,NID10.NAME as CCNID10,
    	NID11.NAME as CCNID11,NID12.NAME as CCNID12,NID13.NAME as CCNID13,NID14.NAME as CCNID14,NID15.NAME as CCNID15,NID16.NAME as CCNID16,NID17.NAME as CCNID17,NID18.NAME as CCNID18,NID19.NAME as CCNID19,NID20.NAME as CCNID20,
		NID21.NAME as CCNID21,NID22.NAME as CCNID22,NID23.NAME as CCNID23,NID24.NAME as CCNID24,NID25.NAME as CCNID25,NID26.NAME as CCNID26,NID27.NAME as CCNID27,NID28.NAME as CCNID28,NID29.NAME as CCNID29,NID30.NAME as CCNID30,
		NID31.NAME as CCNID31,NID32.NAME as CCNID32,NID33.NAME as CCNID33,NID34.NAME as CCNID34,NID35.NAME as CCNID35,NID36.NAME as CCNID36,NID37.NAME as CCNID37,NID38.NAME as CCNID38,NID39.NAME as CCNID39,NID40.NAME as CCNID40,
		NID41.NAME as CCNID41,NID42.NAME as CCNID42,NID43.NAME as CCNID43,NID44.NAME as CCNID44,NID45.NAME as CCNID45,NID46.NAME as CCNID46,NID47.NAME as CCNID47,NID48.NAME as CCNID48,NID49.NAME as CCNID49,NID50.NAME as CCNID50 ,
		A.CreatedBy as UserName,A.ContactID
FROM         CRM_Activities AS A WITH(NOLOCK) 	LEFT OUTER JOIN
                      CRM_Campaigns AS L WITH(NOLOCK) 	ON L.campaignid = A.NodeID AND A.CostCenterID = 128 LEFT OUTER JOIN
                      COM_Schedules AS S WITH(NOLOCK) 	ON S.ScheduleID = A.ScheduleID LEFT OUTER JOIN
                      COM_CCSchedules AS CS WITH(NOLOCK) 	ON CS.ScheduleID = A.ScheduleID
                      LEFT JOIN COM_DIVISION NID1 WITH(NOLOCK) 	on A.CCNID1=NID1.NODEID
						LEFT JOIN COM_Location NID2 WITH(NOLOCK) 	on A.CCNID2=NID2.NODEID
						LEFT JOIN COM_Branch NID3 WITH(NOLOCK) 	on A.CCNID3=NID3.NODEID
						LEFT JOIN COM_Department NID4 WITH(NOLOCK) 	on A.CCNID4=NID4.NODEID
						LEFT JOIN COM_Salesman NID5 WITH(NOLOCK) 	on A.CCNID5=NID5.NODEID
						LEFT JOIN COM_Category NID6 WITH(NOLOCK) 	on A.CCNID6=NID6.NODEID
						LEFT JOIN COM_Area NID7 WITH(NOLOCK) 	on A.CCNID7=NID7.NODEID
						LEFT JOIN COM_Teritory NID8 WITH(NOLOCK) 	on A.CCNID8=NID8.NODEID
						LEFT JOIN COM_CC50009 NID9 WITH(NOLOCK) 	on A.CCNID9=NID9.NODEID
						LEFT JOIN COM_CC50010 NID10 WITH(NOLOCK) 	on A.CCNID10=NID10.NODEID
						LEFT JOIN COM_CC50011 NID11 WITH(NOLOCK) 	on A.CCNID11=NID11.NODEID
						LEFT JOIN COM_CC50012 NID12 WITH(NOLOCK) 	on A.CCNID12=NID12.NODEID
						LEFT JOIN COM_CC50013 NID13 WITH(NOLOCK) 	on A.CCNID13=NID13.NODEID
						LEFT JOIN COM_CC50014 NID14 WITH(NOLOCK) 	on A.CCNID14=NID14.NODEID
						LEFT JOIN COM_CC50015 NID15 WITH(NOLOCK) 	on A.CCNID15=NID15.NODEID
						LEFT JOIN COM_CC50016 NID16 WITH(NOLOCK) 	on A.CCNID16=NID16.NODEID
						LEFT JOIN COM_CC50017 NID17 WITH(NOLOCK) 	on A.CCNID17=NID17.NODEID
						LEFT JOIN COM_CC50018 NID18 WITH(NOLOCK) 	on A.CCNID18=NID18.NODEID
						LEFT JOIN COM_CC50019 NID19 WITH(NOLOCK) 	on A.CCNID19=NID19.NODEID 
						LEFT JOIN COM_CC50020 NID20 WITH(NOLOCK) 	ON A.CCNID20=NID20.NODEID
						LEFT JOIN COM_CC50021 NID21 WITH(NOLOCK) 	ON A.CCNID21=NID21.NODEID
						LEFT JOIN COM_CC50022 NID22 WITH(NOLOCK) 	ON A.CCNID22=NID22.NODEID
						LEFT JOIN COM_CC50023 NID23 WITH(NOLOCK) 	ON A.CCNID23=NID23.NODEID
						LEFT JOIN COM_CC50024 NID24 WITH(NOLOCK) 	ON A.CCNID24=NID24.NODEID
						LEFT JOIN COM_CC50025 NID25 WITH(NOLOCK) 	ON A.CCNID25=NID25.NODEID
						LEFT JOIN COM_CC50026 NID26 WITH(NOLOCK) 	ON A.CCNID26=NID26.NODEID
						LEFT JOIN COM_CC50027 NID27 WITH(NOLOCK) 	ON A.CCNID27=NID27.NODEID
						LEFT JOIN COM_CC50028 NID28 WITH(NOLOCK) 	ON A.CCNID28=NID28.NODEID
						LEFT JOIN COM_CC50029 NID29 WITH(NOLOCK) 	ON A.CCNID29=NID29.NODEID 
						LEFT JOIN COM_CC50030 NID30 WITH(NOLOCK) 	ON A.CCNID30=NID30.NODEID
						LEFT JOIN COM_CC50031 NID31 WITH(NOLOCK) 	ON A.CCNID31=NID31.NODEID
						LEFT JOIN COM_CC50032 NID32 WITH(NOLOCK) 	ON A.CCNID32=NID32.NODEID
						LEFT JOIN COM_CC50033 NID33 WITH(NOLOCK) 	ON A.CCNID33=NID33.NODEID
						LEFT JOIN COM_CC50034 NID34 WITH(NOLOCK) 	ON A.CCNID34=NID34.NODEID
						LEFT JOIN COM_CC50035 NID35 WITH(NOLOCK) 	ON A.CCNID35=NID35.NODEID
						LEFT JOIN COM_CC50036 NID36 WITH(NOLOCK) 	ON A.CCNID36=NID36.NODEID
						LEFT JOIN COM_CC50037 NID37 WITH(NOLOCK) 	ON A.CCNID37=NID37.NODEID
						LEFT JOIN COM_CC50038 NID38 WITH(NOLOCK) 	ON A.CCNID38=NID38.NODEID
						LEFT JOIN COM_CC50039 NID39 WITH(NOLOCK) 	ON A.CCNID39=NID39.NODEID 
						LEFT JOIN COM_CC50040 NID40 WITH(NOLOCK) 	ON A.CCNID40=NID40.NODEID
						LEFT JOIN COM_CC50041 NID41 WITH(NOLOCK) 	ON A.CCNID41=NID41.NODEID
						LEFT JOIN COM_CC50042 NID42 WITH(NOLOCK) 	ON A.CCNID42=NID42.NODEID
						LEFT JOIN COM_CC50043 NID43 WITH(NOLOCK) 	ON A.CCNID43=NID43.NODEID
						LEFT JOIN COM_CC50044 NID44 WITH(NOLOCK) 	ON A.CCNID44=NID44.NODEID
						LEFT JOIN COM_CC50045 NID45 WITH(NOLOCK) 	ON A.CCNID45=NID45.NODEID
						LEFT JOIN COM_CC50046 NID46 WITH(NOLOCK) 	ON A.CCNID46=NID46.NODEID
						LEFT JOIN COM_CC50047 NID47 WITH(NOLOCK) 	ON A.CCNID47=NID47.NODEID
						LEFT JOIN COM_CC50048 NID48 WITH(NOLOCK) 	ON A.CCNID48=NID48.NODEID
						LEFT JOIN COM_CC50049 NID49 WITH(NOLOCK) 	ON A.CCNID49=NID49.NODEID 
						LEFT JOIN COM_CC50050 NID50 WITH(NOLOCK) 	ON A.CCNID50=NID50.NODEID
WHERE     (L.CampaignID =  @CampaignID)
and  ((A.Createdby in (select UserName from #tblUsers) 
	or   (@UserID in ( select UserID from CRM_Assignment where CCID=128 and CCNODEID=L.CampaignID    
	 AND IsFromActivity=A.ActivityID and IsTeam=0 ) 
	  or  @UserID in ( select  UserID from COM_GROUPS where   GROUPNAME<>'' AND GID  IN  
	  (select teamnodeid from CRM_Assignment where CCID=128 and CCNODEID=L.CampaignID  and IsFromActivity=A.ActivityID AND ISGROUP=1) ) OR  
	  @UserID in ( select  UserID from ADM_UserRoleMap where ROLEID IN  
	  (select teamnodeid from CRM_Assignment where CCID=128 and CCNODEID=L.CampaignID  and IsFromActivity=A.ActivityID and ISROLE=1) )  
	 or @UserID in            
	 (select userid from crm_teams where isowner=0 and  teamid in            
	 ( select teamnodeid from CRM_Assignment where CCID=128 and CCNODEID=L.CampaignID  and IsFromActivity=A.ActivityID and IsTeam=1)) ) )      )   
	   
	  select isnull(value,0) ccid from COM_CostCenterPreferences where CostCenterID=88 and Name='CheckListDimension'

SET NOCOUNT OFF;
RETURN 1
END TRY
BEGIN CATCH  
	--Return exception info [Message,Number,ProcedureName,LineNumber]  
	IF ERROR_NUMBER()=50000
	BEGIN
		SELECT ErrorMessage,ErrorNumber FROM COM_ErrorMessages WITH(nolock) WHERE ErrorNumber=ERROR_MESSAGE() AND LanguageID=@LangID
	END
	ELSE
	BEGIN
		SELECT ErrorMessage, ERROR_MESSAGE() AS ServerMessage,ERROR_NUMBER() as ErrorNumber, ERROR_PROCEDURE()as ProcedureName, ERROR_LINE() AS ErrorLine
		FROM COM_ErrorMessages WITH(nolock) WHERE ErrorNumber=-999 AND LanguageID=@LangID
	END
SET NOCOUNT OFF  
RETURN -999   
END CATCH  

GO
